{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nvar __jsx = React.createElement;\nimport React, { useState, useCallback } from 'react';\nimport styled from 'styled-components';\nimport { Landing, Research, WhitePaper, CaseStudies, Survey } from '../sections/research-section';\nimport { Layout, ContactFooter, ResearchPdfForm, StartDownloadForm, Modal, AnimatedFooterLink, ThankYou } from '../components';\nimport pdfMapper from '../utils/pdfMapper'; // Utils\n\nimport { validateEmail } from '../utils/validator';\nimport { sendEmail } from '../services/apiService';\nimport { useStore } from '../store/useStore';\nimport { USER_SIGNED_UP } from '../store/actionTypes';\nconst ContentWrapper = styled.div.withConfig({\n  displayName: \"research__ContentWrapper\",\n  componentId: \"sc-8mb7la-0\"\n})([\"max-width:1200px;margin:0 auto;padding:0 20px;margin-bottom:100px;\"]);\nexport default (() => {\n  const {\n    0: pdfForm,\n    1: setPdfForm\n  } = useState('');\n  const {\n    0: modalVisible,\n    1: setModalVisible\n  } = useState(false);\n  const {\n    0: emailSent,\n    1: setEmailSent\n  } = useState(false);\n  const {\n    0: hasError,\n    1: setHasError\n  } = useState(false);\n  const {\n    0: form,\n    1: setFormValues\n  } = useState({\n    firstName: '',\n    company: '',\n    email: ''\n  }); // Hooks to save the users form data\n\n  const {\n    state,\n    dispatch\n  } = useStore();\n  const saveUser = useCallback(formValues => dispatch({\n    type: USER_SIGNED_UP,\n    payload: formValues\n  }), [dispatch]);\n\n  const updateField = e => {\n    setFormValues(_objectSpread({}, form, {\n      [e.target.name]: e.target.value\n    }));\n  };\n\n  const onSubmit = async () => {\n    try {\n      const res = await sendEmail(form);\n\n      if (res.error) {\n        setHasError(true);\n      } else {\n        // Save user form to store\n        saveUser({\n          name: form.firstName,\n          company: form.company,\n          email: form.email\n        });\n        setEmailSent(true);\n      }\n    } catch (err) {\n      setHasError(true);\n    }\n  };\n\n  const onModalClose = () => {\n    setModalVisible(false);\n    setEmailSent(false);\n  };\n\n  const openModal = researchForm => {\n    setModalVisible(true);\n    setPdfForm(pdfMapper[researchForm]);\n  };\n\n  const isDisabled = form.firstName === '' || !validateEmail(form.email);\n  return __jsx(Layout, null, __jsx(Landing, null), __jsx(Modal, {\n    modalVisible: modalVisible,\n    onRequestClose: onModalClose\n  }, !emailSent && !hasError && !state.user && __jsx(ResearchPdfForm, {\n    firstName: form.firstName,\n    company: form.company,\n    email: form.email,\n    onChange: updateField,\n    isDisabled: isDisabled,\n    onRequestClose: onModalClose,\n    onSubmit: onSubmit,\n    pdfForm: pdfForm\n  }), !emailSent && !hasError && state.user && __jsx(StartDownloadForm, {\n    onRequestClose: onModalClose,\n    pdfForm: pdfForm,\n    onSubmit: () => setEmailSent(true)\n  }), emailSent && !hasError && __jsx(ThankYou, {\n    description: \"Your download should start automatically. Enjoy!\",\n    footerMessage: \"Back to research\",\n    href: \"/research\",\n    onClick: onModalClose\n  })), __jsx(ContentWrapper, null, __jsx(Research, {\n    onClick: openModal\n  }), __jsx(WhitePaper, {\n    onClick: openModal\n  }), __jsx(CaseStudies, {\n    onClick: openModal\n  }), __jsx(Survey, {\n    onClick: openModal\n  }), __jsx(AnimatedFooterLink, {\n    message: \"Back to home\",\n    href: \"/\"\n  })), __jsx(ContactFooter, null));\n});","map":null,"metadata":{},"sourceType":"module"}